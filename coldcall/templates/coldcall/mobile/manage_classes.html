{% include 'coldcall/mobile/base.html' %}

{% load static %}

<!DOCTYPE html>
<html lang="en">
  {% load static %}
  <head>
    <meta charset="UTF-8" />
    {% block styles %}
    <link rel="stylesheet" href="{% static 'coldcall/mobile/style.css' %}" />
    <link rel="stylesheet" href="{% static 'coldcall/mobile/manage_classes.css' %}" />
    {% endblock %}
    <script src="{% static 'coldcall/js/button_confirm.js' %}"></script>
    <title>Manage Classes</title>
  </head>
  <body>
    <!-- Class Filter Dropdown -->
    <div class="filter-container">
        <a href="{% url 'add_class' %}" class="add-class-button">Add Class</a>
        <form method="get">
          <label for="class_filter">Filter Classes:</label>
          <select
            id="class_filter"
            name="class_filter"
            onchange="this.form.submit()">
            <option value="active" {% if not request.GET.class_filter or request.GET.class_filter == 'active' %}selected{% endif %}>Active Classes</option>
            <option value="archived" {% if request.GET.class_filter == 'archived' %}selected{% endif %}>Archived Classes</option>
            <option value="all" {% if request.GET.class_filter == 'all' %}selected{% endif %}>All Classes</option>
          </select>
        </form>
      </div> 

      <div class="table-container">
      <table class="classes-table">
        <thead>
          <tr>
        <th>Class Name</th>
        <th>Edit</th>
        <th>Export</th>
        <th>Add Students</th>
          </tr>
        </thead>
        <tbody>
          {% for class in classes %}
          <tr>
        <td>
            {% if not class.is_archived %}
            <a href="/?class_id={{ class.id }}">{{ class.class_name }}</a>
            {% else %}
            {{ class.class_name }}
            {% endif %}
        </td>
        <td><a href="{% url 'edit_class' class.id %}">Edit</a></td>
        <td><a href="{% url 'export_class_file_with_id' class.id %}">Export</a></td>
        <td>
          <!-- Only allow students to be added to active classes -->
          {% if not class.is_archived %}
          <a href="{% url 'add_student_manual' class.id %}">Manual</a> |
          <a href="{% url 'add_student_import_with_id' class.id %}">Import CSV</a>
          {% endif %}
        </td>
          </tr>
          {% empty %}
          <tr>
        <td colspan="8">No classes found</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </body>
</html>

